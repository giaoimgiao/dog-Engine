# ğŸš€ Dogå†™ä½œå¼•æ“ - æ–°ä¸€ä»£AIå°è¯´åˆ›ä½œå¹³å°

<div align="center">

**ä¸€æ¬¾é›†ã€ŒAIåˆ›ä½œã€ã€Œåœ¨çº¿é˜…è¯»ã€ã€Œæ™ºèƒ½åˆ†æã€äºä¸€ä½“çš„å…¨æ ˆç½‘æ–‡åˆ›ä½œå¼•æ“**

[![Next.js](https://img.shields.io/badge/Next.js-15-black?style=flat-square&logo=next.js)](https://nextjs.org/)
[![React](https://img.shields.io/badge/React-18-blue?style=flat-square&logo=react)](https://reactjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?style=flat-square&logo=typescript)](https://www.typescriptlang.org/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.0-38B2AC?style=flat-square&logo=tailwind-css)](https://tailwindcss.com/)
[![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)](LICENSE)

[![AI Providers](https://img.shields.io/badge/AI_Providers-7+-blueviolet?style=flat-square&logo=openai)](https://github.com/)
[![Multi-Model](https://img.shields.io/badge/Multi--Model-Supported-orange?style=flat-square&logo=google-gemini)](https://github.com/)
[![Config Import/Export](https://img.shields.io/badge/Config-Import%2FExport-success?style=flat-square&logo=json)](https://github.com/)
[![Reverse Engineering](https://img.shields.io/badge/Reverse-Engineering-red?style=flat-square&logo=hackthebox)](https://github.com/)

[åŠŸèƒ½ç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [æŠ€æœ¯æ¶æ„](#-æŠ€æœ¯æ¶æ„) â€¢ [æ ¸å¿ƒæŠ€æœ¯](#-æ ¸å¿ƒæŠ€æœ¯å®ç°) â€¢ [æ–‡æ¡£](#-æ–‡æ¡£å¯¼èˆª)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

Dogå†™ä½œå¼•æ“æ˜¯ä¸€æ¬¾ä¸“ä¸ºç½‘æ–‡ä½œè€…æ‰“é€ çš„**å¼€æºå…¨æ ˆåˆ›ä½œå¹³å°**ï¼ŒåŸºäº Next.js 15 + TypeScript æ„å»ºã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå†™ä½œå·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªé›†æˆäº†AIè¾…åŠ©åˆ›ä½œã€åœ¨çº¿ä¹¦åŸã€æ™ºèƒ½åˆ†æã€å›¾ç‰‡ç”Ÿæˆç­‰å¤šåŠŸèƒ½çš„**ä¸€ç«™å¼åˆ›ä½œç”Ÿæ€ç³»ç»Ÿ**ã€‚

### ğŸ¯ æ ¸å¿ƒäº®ç‚¹

- ğŸ¯ **ç»Ÿä¸€AIå®¢æˆ·ç«¯** - æ”¯æŒ7+AIæœåŠ¡å•†ï¼ˆGeminiã€OpenAIã€Claudeã€DeepSeekã€Moonshotã€æ™ºè°±AIã€è‡ªå®šä¹‰ï¼‰ï¼Œä¸€å¥—ä»£ç å…¼å®¹æ‰€æœ‰æ¨¡å‹
- ğŸ“¦ **é…ç½®å¯¼å…¥å¯¼å‡º** - å®Œæ•´çš„Provideré…ç½®ç®¡ç†ç³»ç»Ÿï¼ŒJSONæ ¼å¼å¯¼å…¥å¯¼å‡ºï¼Œæ”¯æŒæ‰¹é‡é…ç½®å’ŒéªŒè¯
- âš¡ **æ™ºèƒ½è·¯ç”±** - è‡ªåŠ¨é€‰æ‹©æœ€ä½³AIæä¾›å•†ï¼Œæ”¯æŒæ•…éšœè½¬ç§»å’Œè´Ÿè½½å‡è¡¡
- ğŸ” **AIç‡æ£€æµ‹ï¼ˆé€†å‘å·¥ç¨‹ï¼‰** - é€šè¿‡é€†å‘ailv.run APIï¼Œå®ç°å…è´¹çš„AIç”Ÿæˆå†…å®¹æ£€æµ‹ï¼Œç²¾å‡†è¿”å›åŸå§‹æ¦‚ç‡å€¼
- ğŸ¨ **AIå›¾ç‰‡ç”Ÿæˆ** - é›†æˆè±†åŒ…AIï¼Œæ”¯æŒSSEæµå¼å¤„ç†å’Œæ‰¹é‡ç”Ÿå›¾
- ğŸ“š **æ™ºèƒ½ä¹¦åŸç³»ç»Ÿ** - å¤šä¹¦æºè§£æå¼•æ“ï¼Œæ”¯æŒæœç´¢ã€åˆ†ç±»ã€è¯¦æƒ…ã€ç« èŠ‚é˜…è¯»ï¼Œé…å¤‡æ™ºèƒ½ç¼“å­˜
- ğŸ¤– **AIå°è¯´ä»¿å†™** - å®Œæ•´çš„å¯¹è¯ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒæ¶ˆæ¯ç¼–è¾‘/åˆ é™¤ã€å¤šè¡Œè¾“å…¥ã€ä¸Šä¸‹æ–‡ä¿æŒ
- ğŸ­ **ä¸“ä¸šåˆ›ä½œå·¥å…·é›†** - ç« èŠ‚ç®¡ç†ã€è§’è‰²å¡ç‰‡ã€ä¸–ç•Œè®¾å®šã€ç»†çº²æ‹†è§£
- ğŸ“± **ç§»åŠ¨ç«¯ä¼˜åŒ–** - å“åº”å¼å›¾å¢™å¸ƒå±€ï¼Œå®Œç¾é€‚é…å„ç§å±å¹•å°ºå¯¸
- ğŸ’¾ **å¤šçº§ç¼“å­˜** - æ™ºèƒ½ç¼“å­˜ç­–ç•¥ï¼Œå‡å°‘90%é‡å¤è¯·æ±‚
- ğŸ“Š **ä½¿ç”¨ç»Ÿè®¡** - å®æ—¶è¿½è¸ªTokenæ¶ˆè€—ã€å“åº”æ—¶é—´ã€æä¾›å•†ä½¿ç”¨æƒ…å†µ

---

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### 1. ğŸ’¡ AIæ™ºèƒ½åˆ›ä½œç³»ç»Ÿ

#### ğŸ¯ ä¸“ä¸šå°è¯´åˆ†æåŠŸèƒ½
- **ä»¿å†™å¼€å¤´** - æ·±åº¦åˆ†æå†™ä½œæŠ€å·§ï¼Œç”Ÿæˆç±»ä¼¼é£æ ¼çš„å¼€å¤´
- **å‰§æƒ…æ€»ç»“** - æ™ºèƒ½æå–æ•…äº‹çº¿ç´¢å’Œå…³é”®è½¬æŠ˜ç‚¹
- **å–ç‚¹åˆ†æ** - æŒ–æ˜ç‹¬ç‰¹è®¾å®šå’Œå¸å¼•è¯»è€…çš„æ ¸å¿ƒå…ƒç´ 
- **è§’è‰²åˆ†æ** - æ·±åº¦è§£æä¸»è¦è§’è‰²æ€§æ ¼ç‰¹ç‚¹å’Œæˆé•¿å¼§çº¿
- **é£æ ¼åˆ†æ** - åˆ†æä½œè€…æ–‡ç¬”ç‰¹è‰²å’Œå™äº‹æŠ€å·§

#### ğŸ’¬ å®Œæ•´å¯¹è¯ç®¡ç†
- **æ¶ˆæ¯ç¼–è¾‘** - é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæ“ä½œèœå•ï¼Œæ”¯æŒå®æ—¶ç¼–è¾‘
- **æ¶ˆæ¯åˆ é™¤** - çµæ´»ç®¡ç†å¯¹è¯å†å²
- **ä¸€é”®æ¸…ç©º** - å¿«é€Ÿé‡ç½®ä¼šè¯çŠ¶æ€
- **å¤šè¡Œè¾“å…¥** - Textareaæ”¯æŒï¼ŒEnteræ¢è¡Œï¼ŒCtrl+Enterå‘é€
- **ä¸Šä¸‹æ–‡ä¿æŒ** - å®Œæ•´çš„å¯¹è¯å†å²ç®¡ç†ï¼ŒAIè®°ä½æ‰€æœ‰ä¸Šä¸‹æ–‡
- **å¿«æ·é”®æ”¯æŒ** - Escå–æ¶ˆç¼–è¾‘ï¼ŒCtrl+Enterä¿å­˜

#### ğŸ”§ æŠ€æœ¯å®ç°
```typescript
// å¯¹è¯å†å²ç®¡ç† - ç« èŠ‚å†…å®¹ä½œä¸ºç³»ç»Ÿä¸Šä¸‹æ–‡
const conversationHistory = [
  { role: 'system', content: chapterContext },
  ...messages.map(msg => ({
    role: msg.role,
    content: msg.content
  }))
];

// ç›´æ¥è°ƒç”¨Gemini APIï¼Œæ— éœ€åç«¯
const response = await fetch(
  `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`,
  { method: 'POST', body: JSON.stringify({ contents: conversationHistory }) }
);
```

### 2. ğŸ¨ AIå›¾ç‰‡ç”Ÿæˆå¼•æ“

#### æ ¸å¿ƒåŠŸèƒ½
- **SSEæµå¼å¤„ç†** - å®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
- **æ‰¹é‡ç”Ÿå›¾** - ä¸€æ¬¡ç”Ÿæˆå¤šå¼ å›¾ç‰‡
- **è½®è¯¢æœºåˆ¶** - è‡ªåŠ¨è·å–ç”Ÿæˆç»“æœ
- **å›¾ç‰‡ç®¡ç†** - æ”¯æŒä¸‹è½½ã€é“¾æ¥å¤åˆ¶
- **ç§»åŠ¨ç«¯é€‚é…** - å“åº”å¼ç½‘æ ¼å¸ƒå±€

#### æŠ€æœ¯æ¶æ„
```typescript
// Next.js APIè·¯ç”± - è±†åŒ…APIé€‚é…
export async function POST(request: Request) {
  const encoder = new TextEncoder();
  const stream = new TransformStream();
  const writer = stream.writable.getWriter();
  
  // SSEæµå¼æ¨é€
  writer.write(encoder.encode(`data: ${JSON.stringify(event)}\n\n`));
  
  return new Response(stream.readable, {
    headers: { 'Content-Type': 'text/event-stream' }
  });
}
```

### 3. ğŸ“š æ™ºèƒ½ä¹¦åŸç³»ç»Ÿ

#### å¤šä¹¦æºè§£æå¼•æ“
- **æœç´¢åŠŸèƒ½** - è·¨ä¹¦æºæ™ºèƒ½æœç´¢
- **åˆ†ç±»æµè§ˆ** - æŒ‰ç±»å‹/æ ‡ç­¾ç­›é€‰
- **çƒ­é—¨æ¨è** - å®æ—¶çƒ­é—¨ä¹¦ç±æ¦œå•
- **ä¹¦ç±è¯¦æƒ…** - å®Œæ•´ä¿¡æ¯å±•ç¤ºï¼ˆå°é¢ã€ç®€ä»‹ã€ä½œè€…ã€çŠ¶æ€ï¼‰
- **ç« èŠ‚ç›®å½•** - æ™ºèƒ½è§£æå®Œæ•´ç›®å½•
- **åœ¨çº¿é˜…è¯»** - æ”¯æŒå¤šé¡µå†…å®¹è‡ªåŠ¨æ‹¼æ¥

#### æ™ºèƒ½ç¼“å­˜ç­–ç•¥
```typescript
// åˆ†çº§ç¼“å­˜ç³»ç»Ÿ
const CACHE_DURATIONS = {
  hot: 30 * 60 * 1000,      // çƒ­é—¨ä¹¦ç±ï¼š30åˆ†é’Ÿ
  categories: 60 * 60 * 1000, // åˆ†ç±»åˆ—è¡¨ï¼š1å°æ—¶
  search: 15 * 60 * 1000,     // æœç´¢ç»“æœï¼š15åˆ†é’Ÿ
  category: 20 * 60 * 1000,   // åˆ†ç±»é¡µé¢ï¼š20åˆ†é’Ÿ
  book: 30 * 60 * 1000,       // ä¹¦ç±è¯¦æƒ…ï¼š30åˆ†é’Ÿ
};

// è‡ªåŠ¨è¿‡æœŸæ£€æµ‹å’Œæ¸…ç†
const cached = localStorage.getItem(cacheKey);
if (cached && Date.now() < cached.timestamp + cached.expiry) {
  return cached.data; // å‘½ä¸­ç¼“å­˜
}
```

#### é«˜çº§è§£æèƒ½åŠ›
- **JavaScriptæ‰§è¡Œ** - æ”¯æŒ `<js>` ä»£ç å—åŠ¨æ€è§£æ
- **æ··åˆè§„åˆ™** - `@css` + `@js` é€‰æ‹©å™¨ç»„åˆ
- **JSONPath** - å®Œæ•´çš„JSONPathè¡¨è¾¾å¼æ”¯æŒ
- **å ä½ç¬¦æ›¿æ¢** - `{{page}}`ã€`{{host()}}`ã€`{{source.xxx}}`
- **æ­£åˆ™å¤„ç†** - `replaceRegex`ã€`sourceRegex` æ–‡æœ¬æ¸…æ´—
- **å¯¼èˆªæ™ºèƒ½** - åŒé‡å¯¼èˆªç³»ç»Ÿï¼ˆç« èŠ‚åˆ—è¡¨ + HTMLæå–ï¼‰

### 4. ğŸ­ ä¸“ä¸šåˆ›ä½œå·¥å…·é›†

#### ChapterManager - ç« èŠ‚ç®¡ç†å™¨
- è‰ç¨¿ä¸æˆç¨¿åˆ†ç¦»ç®¡ç†
- ç« èŠ‚ç‰ˆæœ¬æ§åˆ¶
- æ‰¹é‡å¯¼å…¥/å¯¼å‡º
- å­—æ•°ç»Ÿè®¡ä¸è¿›åº¦è¿½è¸ª

#### CharacterCardManager - è§’è‰²å¡ç‰‡ç³»ç»Ÿ
- å®Œæ•´çš„äººç‰©æ¡£æ¡ˆç®¡ç†
- è§’è‰²å…³ç³»å›¾è°±
- æ€§æ ¼ç‰¹å¾æ ‡ç­¾åŒ–
- AIè¾…åŠ©è§’è‰²è®¾å®šç”Ÿæˆ

#### WorldBookManager - ä¸–ç•Œè§‚ç®¡ç†
- è®¾å®šåˆ†ç±»ç®¡ç†
- çŸ¥è¯†åº“æ„å»º
- æ—¶é—´çº¿ç®¡ç†
- è®¾å®šå†²çªæ£€æµ‹

#### DeconstructOutline - ç»†çº²æ‹†è§£
- ä»æ­£æ–‡æ™ºèƒ½æå–ç»†çº²
- è‡ªåŠ¨ç”Ÿæˆå‰§æƒ…éª¨æ¶
- æƒ…èŠ‚ç‚¹æ ‡æ³¨
- èŠ‚å¥åˆ†æ

### 5. ğŸ” AIç‡æ£€æµ‹ç³»ç»Ÿï¼ˆé€†å‘å·¥ç¨‹ï¼‰

#### æ ¸å¿ƒçªç ´
- **é€†å‘ailv.run API** - é€šè¿‡æŠ“åŒ…åˆ†æï¼Œå®Œæ•´å¤ç°AIæ£€æµ‹æœåŠ¡
- **åè®®ä¼ªè£…** - è‡ªåŠ¨æ·»åŠ Originã€Refererã€User-Agentæ¨¡æ‹ŸçœŸå®æµè§ˆå™¨
- **åŸå§‹æ¦‚ç‡å€¼** - è¿”å›æœªå¤„ç†çš„AIæ¦‚ç‡å’Œäººç±»æ¦‚ç‡åŸå§‹æ•°æ®
- **å®æ—¶æ£€æµ‹** - æ— éœ€æ³¨å†Œï¼Œå…è´¹ä½¿ç”¨

#### æŠ€æœ¯å®ç°
```typescript
// é€†å‘åˆ†æçš„APIç«¯ç‚¹
const AILV_API_URL = 'https://a.ailv.run/analyze';

// ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´ï¼Œç»•è¿‡åçˆ¬è™«
headers: {
  'Content-Type': 'application/json',
  'Origin': 'https://www.ailv.run',
  'Referer': 'https://www.ailv.run/',
  'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)...'
}

// è¿”å›åŸå§‹æ£€æµ‹ç»“æœ
{
  avgAiProbability: 0.85,      // AIç”Ÿæˆæ¦‚ç‡
  avgHumanProbability: 0.15    // äººç±»åˆ›ä½œæ¦‚ç‡
}
```

**é€†å‘è¿‡ç¨‹**ï¼š
1. æŠ“åŒ…åˆ†æç›®æ ‡ç½‘ç«™APIè¯·æ±‚
2. æå–å…³é”®è¯·æ±‚å¤´å’Œpayloadæ ¼å¼
3. å°è£…ä¸ºNext.js APIè·¯ç”±
4. æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ

### 6. ğŸ“± å“åº”å¼è®¾è®¡

#### ç§»åŠ¨ç«¯å›¾å¢™å¸ƒå±€
```css
/* å“åº”å¼ç½‘æ ¼ */
grid-cols-3 (æ‰‹æœº) 
â†’ grid-cols-4 (å¹³æ¿) 
â†’ grid-cols-5 (æ¡Œé¢) 
â†’ grid-cols-6 (å¤§å±)
```

- **Hoveræ•ˆæœ** - å›¾ç‰‡è½»å¾®æ”¾å¤§åŠ¨ç”»
- **æ‚¬æµ®å±‚** - ç§»åŠ¨ç«¯hoveræ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- **æœªè¯»æ ‡è¯†** - çº¢è‰²å°åœ†ç‚¹æç¤º
- **è‡ªé€‚åº”é—´è·** - æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´padding/gap

---

## ğŸ›  æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

```
Next.js 15 (App Router + Pages Routeræ··åˆ)
â”œâ”€â”€ React 18 (Hooks + Context)
â”œâ”€â”€ TypeScript 5.0 (ä¸¥æ ¼ç±»å‹æ£€æŸ¥)
â”œâ”€â”€ Tailwind CSS 3.0 (å®ç”¨ä¼˜å…ˆCSS)
â”œâ”€â”€ shadcn/ui (é«˜è´¨é‡ç»„ä»¶åº“)
â”œâ”€â”€ Lucide React (ç°ä»£å›¾æ ‡ç³»ç»Ÿ)
â””â”€â”€ LocalStorage (å®¢æˆ·ç«¯æŒä¹…åŒ–)
```

### AIèƒ½åŠ›å±‚ï¼ˆç»Ÿä¸€AIå®¢æˆ·ç«¯æ¶æ„ï¼‰

```
ç»Ÿä¸€AIå®¢æˆ·ç«¯ (UnifiedAIClient)
â”œâ”€â”€ å¤šæä¾›å•†æ”¯æŒ
â”‚   â”œâ”€â”€ Google Gemini (å®˜æ–¹API)
â”‚   â”œâ”€â”€ OpenAI (ChatGPT)
â”‚   â”œâ”€â”€ Anthropic Claude
â”‚   â”œâ”€â”€ DeepSeek (å›½äº§)
â”‚   â”œâ”€â”€ Moonshot AI (æœˆä¹‹æš—é¢)
â”‚   â”œâ”€â”€ æ™ºè°±AI (ChatGLM)
â”‚   â””â”€â”€ è‡ªå®šä¹‰OpenAIå…¼å®¹ç«¯ç‚¹
â”‚
â”œâ”€â”€ æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ è‡ªåŠ¨è·¯ç”± (æ™ºèƒ½é€‰æ‹©æœ€ä½³Provider)
â”‚   â”œâ”€â”€ ç»Ÿä¸€è°ƒç”¨æ¥å£ (generateContent/Stream)
â”‚   â”œâ”€â”€ è¿æ¥æµ‹è¯• (testConnection)
â”‚   â”œâ”€â”€ æ¨¡å‹åˆ—è¡¨è·å– (listModels)
â”‚   â”œâ”€â”€ é…ç½®å¯¼å…¥å¯¼å‡º (JSONæ ¼å¼)
â”‚   â””â”€â”€ ä½¿ç”¨ç»Ÿè®¡ (tokenè®¡æ•°ã€å“åº”æ—¶é—´)
â”‚
â”œâ”€â”€ é«˜çº§ç‰¹æ€§
â”‚   â”œâ”€â”€ åŠ¨æ€æ€è€ƒ (Gemini 2.5ç³»åˆ—ä¸“ç”¨)
â”‚   â”œâ”€â”€ æ¸©åº¦/Top-P/Top-Kç²¾ç»†æ§åˆ¶
â”‚   â”œâ”€â”€ è‡ªå®šä¹‰è¯·æ±‚å¤´ (ç»•è¿‡é™åˆ¶)
â”‚   â”œâ”€â”€ è¯·æ±‚è¶…æ—¶å’Œé‡è¯•
â”‚   â””â”€â”€ é”™è¯¯åˆ†ç±»å¤„ç† (é…é¢ã€ç½‘ç»œã€è®¤è¯)
â”‚
â””â”€â”€ å‰ç«¯ç›´è°ƒ
    â”œâ”€â”€ æ™ºèƒ½ç»­å†™ã€æ”¹å†™
    â”œâ”€â”€ è§’è‰²æ‰®æ¼”
    â”œâ”€â”€ é£æ ¼è¿ç§»
    â””â”€â”€ ä¸“ä¸šåˆ†æ

è±†åŒ…AIå›¾ç‰‡ç”Ÿæˆ
â”œâ”€â”€ æ–‡ç”Ÿå›¾
â”œâ”€â”€ SSEæµå¼å¤„ç†
â””â”€â”€ æ‰¹é‡ç”Ÿæˆ

å¯é€‰ï¼šæœåŠ¡ç«¯æ‰©å±•
â””â”€â”€ Genkit Flows (é«˜çº§AIå·¥ä½œæµ)
```

### ä¹¦åŸè§£æå¼•æ“

```
å¤šä¹¦æºè§£æç³»ç»Ÿ
â”œâ”€â”€ HTMLè§£æ (cheerio)
â”œâ”€â”€ JavaScriptæ‰§è¡Œ (Functionæ„é€ å™¨)
â”œâ”€â”€ JSONPathè§£æ (è‡ªç ”è§£æå™¨)
â”œâ”€â”€ æ­£åˆ™å¤„ç† (replaceRegex/sourceRegex)
â”œâ”€â”€ å ä½ç¬¦æ›¿æ¢ ({{å˜é‡}}ç³»ç»Ÿ)
â”œâ”€â”€ åˆ†é¡µæ‹¼æ¥ (è‡ªåŠ¨ä¸‹ä¸€é¡µ)
â”œâ”€â”€ å›¾ç‰‡ä»£ç† (/api/proxy-image)
â””â”€â”€ è®¤è¯ç®¡ç† (Cookie/Token)
```

### å­˜å‚¨æ¶æ„

```
å¤šå±‚å­˜å‚¨ç­–ç•¥
â”œâ”€â”€ LocalStorage (ç”¨æˆ·è®¾ç½®ã€APIå¯†é’¥ã€ç¼“å­˜)
â”œâ”€â”€ IndexedDB (å¤§å‹æ•°æ®ã€ç¦»çº¿æ”¯æŒ)
â”œâ”€â”€ Firebase (å¯é€‰äº‘å­˜å‚¨)
â””â”€â”€ æ–‡ä»¶ç³»ç»Ÿ (ä¹¦æºé…ç½®JSON)
```

### APIè·¯ç”±è®¾è®¡

```
/api/
â”œâ”€â”€ bookstore/          # ä¹¦åŸç³»ç»Ÿ
â”‚   â”œâ”€â”€ search         # æœç´¢
â”‚   â”œâ”€â”€ categories     # åˆ†ç±»åˆ—è¡¨
â”‚   â”œâ”€â”€ hot           # çƒ­é—¨ä¹¦ç±
â”‚   â”œâ”€â”€ category      # åˆ†ç±»é¡µé¢
â”‚   â”œâ”€â”€ book          # ä¹¦ç±è¯¦æƒ…
â”‚   â”œâ”€â”€ chapter       # ç« èŠ‚å†…å®¹
â”‚   â””â”€â”€ ai-detector   # AIæ£€æµ‹
â”œâ”€â”€ ai-image/
â”‚   â””â”€â”€ generate      # å›¾ç‰‡ç”Ÿæˆï¼ˆSSEï¼‰
â”œâ”€â”€ community/
â”‚   â””â”€â”€ forward       # ç¤¾åŒºè½¬å‘
â”œâ”€â”€ proxy-image       # å›¾ç‰‡ä»£ç†
â””â”€â”€ test-proxy        # ä»£ç†æµ‹è¯•
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18.0+
- npm 9.0+ æˆ– pnpm 8.0+

### å®‰è£…æ­¥éª¤

#### 1ï¸âƒ£ å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-username/dog-writing-engine.git
cd dog-writing-engine
```

#### 2ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
npm install
# æˆ–
pnpm install
```

#### 3ï¸âƒ£ å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® `http://localhost:9002` ğŸ‰

### é¦–æ¬¡é…ç½®

#### ğŸ¤– é…ç½®AIæä¾›å•†ï¼ˆæ¨èï¼šç»Ÿä¸€AIé…ç½®ï¼‰

**æ–¹å¼1ï¼šä½¿ç”¨ç»Ÿä¸€AIé…ç½®ç•Œé¢ï¼ˆæ¨èï¼‰**

1. æ‰“å¼€åº”ç”¨å³ä¸‹è§’çš„ **ã€ŒAIé…ç½®ã€** æŒ‰é’®
2. ç‚¹å‡»ã€Œæ·»åŠ æä¾›å•†ã€
3. é€‰æ‹©é¢„è®¾æ¨¡æ¿ï¼ˆGemini / OpenAI / Claude / DeepSeekç­‰ï¼‰
4. å¡«å†™APIå¯†é’¥å’Œé…ç½®ä¿¡æ¯
5. ç‚¹å‡»è¿æ¥æµ‹è¯•ï¼ŒéªŒè¯å¯ç”¨æ€§
6. ä¿å­˜å¹¶å¯ç”¨

**æ”¯æŒçš„AIæœåŠ¡å•†**ï¼š
- **Google Gemini** - å…è´¹é¢åº¦å¤§ï¼Œæ¨è `gemini-2.5-flash`
- **OpenAI** - GPT-4 / GPT-3.5ï¼Œéœ€ä»˜è´¹
- **DeepSeek** - æ€§ä»·æ¯”æé«˜ï¼Œå›½äº§
- **Moonshot AI** - Kimié•¿æ–‡æœ¬ï¼Œæ”¯æŒ200kä¸Šä¸‹æ–‡
- **æ™ºè°±AI** - ChatGLMï¼Œå›½äº§
- **Claude** - Anthropicå‡ºå“ï¼Œé€»è¾‘æ€§å¼º
- **è‡ªå®šä¹‰** - ä»»æ„OpenAIå…¼å®¹ç«¯ç‚¹

**é…ç½®ç®¡ç†åŠŸèƒ½**ï¼š
- âœ… å¤šProvideråŒæ—¶å¯ç”¨ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»
- âœ… é…ç½®å¯¼å‡º/å¯¼å…¥ï¼ˆJSONæ ¼å¼ï¼‰
- âœ… APIå¯†é’¥æ˜¾ç¤º/éšè—/å¤åˆ¶
- âœ… è¿æ¥æµ‹è¯•ï¼ˆæ£€æµ‹å¯ç”¨æ€§å’Œå“åº”æ—¶é—´ï¼‰
- âœ… é«˜çº§å‚æ•°ï¼ˆæ¸©åº¦ã€Top-Pã€Top-Kï¼‰
- âœ… Gemini 2.5 ä¸“ç”¨ï¼šåŠ¨æ€æ€è€ƒæ¨¡å¼

**æ–¹å¼2ï¼šä¼ ç»Ÿå•ä¸€Geminié…ç½®**

1. æ‰“å¼€åº”ç”¨å³ä¸‹è§’çš„ **ã€ŒGeminiè®¾ç½®ã€** æŒ‰é’®
2. ç‚¹å‡»ã€Œè·å–APIå¯†é’¥ã€é“¾æ¥ï¼Œè·³è½¬åˆ° [Google AI Studio](https://aistudio.google.com/app/apikey)
3. ç”Ÿæˆå¹¶å¤åˆ¶API Key
4. ç²˜è´´åˆ°åº”ç”¨çš„API Keyè¾“å…¥æ¡†
5. ç‚¹å‡»ä¿å­˜

**å®‰å…¨æç¤º**ï¼š
- âœ… å¯†é’¥ä»…ä¿å­˜åœ¨æµè§ˆå™¨ `localStorage`
- âœ… ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨
- âœ… å®Œå…¨ç”±ä½ è‡ªå·±æŒæ§

**Geminiå…è´¹é…é¢**ï¼š
- æ¯åˆ†é’Ÿ 15 æ¬¡è¯·æ±‚
- æ¯å¤© 1500 æ¬¡è¯·æ±‚
- æ¨èæ¨¡å‹ï¼š`gemini-2.5-flash`ï¼ˆæ€§ä»·æ¯”æœ€é«˜ï¼‰

#### ğŸ¨ é…ç½®è±†åŒ…AIï¼ˆå¯é€‰ï¼‰

å¦‚éœ€ä½¿ç”¨AIå›¾ç‰‡ç”ŸæˆåŠŸèƒ½ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»º `.env.local`ï¼š

```bash
# è±†åŒ…AIé…ç½®
DOUBAO_API_URL=https://your-doubao-api-endpoint
DOUBAO_API_KEY=your_doubao_api_key
DOUBAO_MODEL_ID=your_model_id
```

è·å–æ–¹å¼ï¼š
1. è®¿é—®ç«å±±å¼•æ“æ§åˆ¶å°
2. åˆ›å»ºè±†åŒ…AIåº”ç”¨
3. å¤åˆ¶ç›¸å…³å‡­è¯

è¯¦è§ï¼š[docs/ai-image-setup.md](docs/ai-image-setup.md)

#### ğŸŒ é…ç½®ä»£ç†ï¼ˆå¯é€‰ï¼‰

ä»…å›½å†…æœåŠ¡å™¨éœ€è¦ï¼Œç”¨äºè®¿é—®GoogleæœåŠ¡ï¼š

```bash
# .env.local
HTTP_PROXY=http://127.0.0.1:7890
HTTPS_PROXY=http://127.0.0.1:7890
```

è¯¦è§ï¼š[docs/proxy-setup.md](docs/proxy-setup.md)

---

## ğŸ“± åŠŸèƒ½è¯¦è§£

### AIä»¿å†™å·¥ä½œåŒº

**è·¯å¾„**ï¼šè¿›å…¥ä¹¦åŸ â†’ é€‰æ‹©ä¹¦ç± â†’ é˜…è¯»ç« èŠ‚ â†’ ç‚¹å‡»ã€Œå¯¼å…¥åˆ°åˆ›ä½œã€

**åŠŸèƒ½æ¸…å•**ï¼š

| åŠŸèƒ½ | æè¿° | å¿«æ·é”® |
|------|------|--------|
| **ä»¿å†™å¼€å¤´** | AIåˆ†æåŸæ–‡å†™ä½œæŠ€å·§å¹¶åˆ›ä½œç±»ä¼¼é£æ ¼çš„å¼€å¤´ | - |
| **å‰§æƒ…æ€»ç»“** | æ™ºèƒ½æå–æ•…äº‹è„‰ç»œå’Œå…³é”®æƒ…èŠ‚ | - |
| **å–ç‚¹åˆ†æ** | åˆ†æå¸å¼•è¯»è€…çš„æ ¸å¿ƒå…ƒç´  | - |
| **è§’è‰²åˆ†æ** | æ·±åº¦è§£æè§’è‰²æ€§æ ¼å’Œå…³ç³» | - |
| **å†™ä½œé£æ ¼** | å‰–æä½œè€…çš„å™äº‹æŠ€å·§ | - |
| **è‡ªç”±å¯¹è¯** | åŸºäºç« èŠ‚å†…å®¹çš„ä»»æ„æé—® | - |
| **æ¶ˆæ¯ç¼–è¾‘** | ä¿®æ”¹å†å²æ¶ˆæ¯é‡æ–°ç”Ÿæˆå“åº” | Ctrl+Enter ä¿å­˜ |
| **æ¶ˆæ¯åˆ é™¤** | ç§»é™¤ä¸éœ€è¦çš„å¯¹è¯è®°å½• | - |
| **æ¸…ç©ºä¼šè¯** | ä¸€é”®é‡ç½®æ‰€æœ‰å¯¹è¯ | - |
| **å¤šè¡Œè¾“å…¥** | æ”¯æŒé•¿æ–‡æœ¬è¾“å…¥å’Œæ¢è¡Œ | Ctrl+Enter å‘é€ |

**æŠ€æœ¯äº®ç‚¹**ï¼š
- å®Œæ•´çš„å¯¹è¯å†å²ç®¡ç†ï¼Œæ”¯æŒã€Œç»§ç»­ã€ç­‰ä¸Šä¸‹æ–‡æŒ‡ä»¤
- å®æ—¶æ¶ˆæ¯ç¼–è¾‘ï¼Œæ— éœ€åˆ·æ–°é¡µé¢
- æ™ºèƒ½æ„å»ºç« èŠ‚ä¸Šä¸‹æ–‡ï¼ŒAIç†è§£å°è¯´ç»“æ„
- Textareaè‡ªåŠ¨é«˜åº¦è°ƒæ•´ï¼ˆ40px-120pxï¼‰

### åœ¨çº¿ä¹¦åŸ

**è·¯å¾„**ï¼šåº•éƒ¨å¯¼èˆª â†’ ä¹¦åŸ

**æ ¸å¿ƒåŠŸèƒ½**ï¼š

#### ğŸ“Š é¦–é¡µ
- **çƒ­é—¨æ¨è** - å®æ—¶çƒ­é—¨æ¦œå•ï¼Œ30åˆ†é’Ÿç¼“å­˜
- **åˆ†ç±»å¯¼èˆª** - å¿«é€Ÿè¿›å…¥å„ç±»å‹ä¹¦ç±
- **æœç´¢å…¥å£** - å…¨ç«™æœç´¢æ”¯æŒ

#### ğŸ” æœç´¢é¡µé¢
- **æ™ºèƒ½æœç´¢** - æ”¯æŒä¹¦åã€ä½œè€…æœç´¢
- **å¤šä¹¦æº** - è‡ªåŠ¨èšåˆå¤šä¸ªä¹¦æºç»“æœ
- **15åˆ†é’Ÿç¼“å­˜** - å‡å°‘é‡å¤æœç´¢è¯·æ±‚

#### ğŸ“‘ åˆ†ç±»é¡µé¢
- **ç±»å‹ç­›é€‰** - ç„å¹»ã€éƒ½å¸‚ã€è¨€æƒ…ç­‰
- **æ’åºæ–¹å¼** - æœ€æ–°ã€æœ€çƒ­ã€è¯„åˆ†
- **20åˆ†é’Ÿç¼“å­˜** - å¿«é€ŸåŠ è½½

#### ğŸ“– ä¹¦ç±è¯¦æƒ…
- **å®Œæ•´ä¿¡æ¯** - å°é¢ã€ç®€ä»‹ã€ä½œè€…ã€çŠ¶æ€ã€æ›´æ–°æ—¶é—´
- **ç« èŠ‚ç›®å½•** - å®Œæ•´ç« èŠ‚åˆ—è¡¨ï¼Œæ”¯æŒå¿«é€Ÿè·³è½¬
- **ä¸€é”®å¯¼å…¥** - å¯¼å…¥ç« èŠ‚åˆ°åˆ›ä½œå·¥ä½œåŒº
- **30åˆ†é’Ÿç¼“å­˜** - æµç•…æµè§ˆä½“éªŒ

#### ğŸ“„ ç« èŠ‚é˜…è¯»
- **å­—ä½“è°ƒèŠ‚** - 5çº§å­—ä½“å¤§å°å¯è°ƒ
- **è¡Œè·è°ƒèŠ‚** - 3çº§è¡Œè·é€‰æ‹©
- **æ™ºèƒ½å¯¼èˆª** - åŒé‡å¯¼èˆªç³»ç»Ÿï¼ˆç« èŠ‚åˆ—è¡¨ä¼˜å…ˆ + HTMLè§£æå¤‡ç”¨ï¼‰
- **å¤šé¡µæ‹¼æ¥** - è‡ªåŠ¨åŠ è½½å¹¶æ‹¼æ¥åˆ†é¡µå†…å®¹
- **è¿›åº¦æ˜¾ç¤º** - å½“å‰ç« èŠ‚ä½ç½®æç¤º

**ç¼“å­˜çŠ¶æ€æ˜¾ç¤º**ï¼š
- ğŸŸ¢ ç»¿è‰²åœ†ç‚¹ + "ç¼“å­˜ä¸­" - æ•°æ®æ¥è‡ªç¼“å­˜
- ğŸ”„ åˆ·æ–°æŒ‰é’® - æ‰‹åŠ¨åˆ·æ–°å¼ºåˆ¶æ›´æ–°

### AIå›¾ç‰‡ç”Ÿæˆ

**è·¯å¾„**ï¼šåº•éƒ¨å¯¼èˆª â†’ ç”Ÿå›¾

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- **æ–‡å­—æè¿°** - è¾“å…¥ä½ æƒ³è¦çš„ç”»é¢æè¿°
- **æç¤ºè¯ç¤ºä¾‹** - å†…ç½®å¤šä¸ªå‚è€ƒæ¡ˆä¾‹
- **å®æ—¶è¿›åº¦** - SSEæµæ˜¾ç¤ºç”ŸæˆçŠ¶æ€
- **æ‰¹é‡å±•ç¤º** - ä¸€æ¬¡ç”Ÿæˆå¤šå¼ å›¾ç‰‡
- **å›¾ç‰‡ç®¡ç†** - ä¸‹è½½ã€å¤åˆ¶é“¾æ¥
- **å“åº”å¼å¸ƒå±€** - ç§»åŠ¨ç«¯å‹å¥½

**æŠ€æœ¯å®ç°**ï¼š
```typescript
// SSEæµå¼æ¥æ”¶
const eventSource = new EventSource('/api/ai-image/generate');
eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.type === 'progress') {
    updateProgress(data.progress);
  } else if (data.type === 'image') {
    displayImage(data.url);
  }
};
```

### åˆ›ä½œç®¡ç†

**è·¯å¾„**ï¼šåº•éƒ¨å¯¼èˆª â†’ åˆ›ä½œ

**æ¨¡å—è¯¦è§£**ï¼š

#### ğŸ“ ç« èŠ‚ç®¡ç†å™¨
```typescript
interface Chapter {
  id: string;
  title: string;
  content: string;
  draft?: string;      // è‰ç¨¿ç‰ˆæœ¬
  wordCount: number;
  createdAt: Date;
  updatedAt: Date;
}
```

- è‰ç¨¿/æˆç¨¿åˆ†ç¦»
- ç‰ˆæœ¬å†å²è®°å½•
- æ‰¹é‡æ“ä½œï¼ˆå¯¼å‡ºã€åˆ é™¤ï¼‰
- å­—æ•°ç»Ÿè®¡å’Œç›®æ ‡è¿½è¸ª

#### ğŸ‘¤ è§’è‰²å¡ç‰‡ç®¡ç†
```typescript
interface Character {
  id: string;
  name: string;
  avatar?: string;
  description: string;
  personality: string[];
  background: string;
  relationships: Relationship[];
}
```

- å®Œæ•´äººç‰©æ¡£æ¡ˆ
- è§’è‰²å…³ç³»å›¾è°±
- AIè¾…åŠ©ç”Ÿæˆ
- æ ‡ç­¾åŒ–ç®¡ç†

#### ğŸŒ ä¸–ç•Œè®¾å®š
```typescript
interface WorldBook {
  id: string;
  category: string;    // åœ°ç†ã€å†å²ã€é­”æ³•ä½“ç³»ç­‰
  name: string;
  description: string;
  tags: string[];
  relatedChapters: string[];
}
```

- åˆ†ç±»ç®¡ç†ï¼ˆåœ°ç†ã€å†å²ã€é­”æ³•ã€ç§‘æŠ€ï¼‰
- çŸ¥è¯†åº“æœç´¢
- è®¾å®šå¼•ç”¨è¿½è¸ª
- å†²çªæ£€æµ‹

#### ğŸ¬ ç»†çº²æ‹†è§£
- AIæ™ºèƒ½æå–å‰§æƒ…ç‚¹
- è‡ªåŠ¨ç”Ÿæˆæ—¶é—´çº¿
- æƒ…èŠ‚ç‚¹æ ‡æ³¨ï¼ˆèµ·ã€æ‰¿ã€è½¬ã€åˆï¼‰
- èŠ‚å¥åˆ†æå›¾è¡¨

---

## ğŸ— é¡¹ç›®ç»“æ„

```
dog-writing-engine/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ ai-image/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ generate/         # è±†åŒ…AIå›¾ç‰‡ç”Ÿæˆï¼ˆSSEï¼‰
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ bookstore/
â”‚   â”‚   â”‚       â””â”€â”€ ai-detector/      # AIç‡æ£€æµ‹
â”‚   â”‚   â”‚           â””â”€â”€ route.ts
â”‚   â”‚   â”œâ”€â”€ bookstore/                # ä¹¦åŸé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx             # ä¸»é¡µï¼ˆçƒ­é—¨+åˆ†ç±»ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ search/              # æœç´¢é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ category/            # åˆ†ç±»é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ book/                # ä¹¦ç±è¯¦æƒ…
â”‚   â”‚   â”‚   â””â”€â”€ read/                # ç« èŠ‚é˜…è¯»
â”‚   â”‚   â”œâ”€â”€ community/                # ç¤¾åŒºåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ review/                   # AIç‡æ£€æµ‹
â”‚   â”‚   â””â”€â”€ settings/                 # è®¾ç½®é¡µé¢
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                   # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AiDetector.tsx           # AIæ£€æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ GeminiSettings.tsx       # Geminié…ç½®
â”‚   â”‚   â”œâ”€â”€ ChapterManager.tsx       # ç« èŠ‚ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ CharacterCardManager.tsx # è§’è‰²ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ WorldBookManager.tsx     # ä¸–ç•Œè§‚ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ DeconstructOutline.tsx   # ç»†çº²æ‹†è§£
â”‚   â”‚   â”œâ”€â”€ Editor.tsx               # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ InlineAIPanel.tsx        # AIä»¿å†™é¢æ¿
â”‚   â”‚   â””â”€â”€ ui/                      # shadcn/uiç»„ä»¶åº“
â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚       â”œâ”€â”€ dialog.tsx
â”‚   â”‚       â”œâ”€â”€ dropdown-menu.tsx
â”‚   â”‚       â”œâ”€â”€ textarea.tsx
â”‚   â”‚       â””â”€â”€ ...                  # 35+ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                         # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ gemini-client.ts        # Gemini APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ book-source-utils.ts    # ä¹¦æºè§£æå¼•æ“
â”‚   â”‚   â”œâ”€â”€ book-source-rule-parser.ts  # è§„åˆ™è§£æå™¨
â”‚   â”‚   â”œâ”€â”€ jsonpath-parser.ts      # JSONPathè§£æ
â”‚   â”‚   â”œâ”€â”€ proxy-fetch.ts          # ä»£ç†è¯·æ±‚å·¥å…·
â”‚   â”‚   â”œâ”€â”€ idb-storage.ts          # IndexedDBå°è£…
â”‚   â”‚   â”œâ”€â”€ clipboard-utils.ts      # å‰ªè´´æ¿å·¥å…·
â”‚   â”‚   â””â”€â”€ ai/                     # AIç»Ÿä¸€å®¢æˆ·ç«¯
â”‚   â”‚       â”œâ”€â”€ unified-client.ts
â”‚   â”‚       â”œâ”€â”€ config-manager.ts
â”‚   â”‚       â””â”€â”€ providers/          # å¤šAIæä¾›å•†
â”‚   â”‚           â”œâ”€â”€ base.ts
â”‚   â”‚           â”œâ”€â”€ gemini.ts
â”‚   â”‚           â””â”€â”€ openai-compatible.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                       # React Hooks
â”‚   â”‚   â”œâ”€â”€ useAI.ts                # AIçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ useAIConfig.ts          # AIé…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ useLocalStorage.ts      # æœ¬åœ°å­˜å‚¨Hook
â”‚   â”‚   â”œâ”€â”€ use-mobile.tsx          # ç§»åŠ¨ç«¯æ£€æµ‹
â”‚   â”‚   â””â”€â”€ use-toast.ts            # Toasté€šçŸ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/api/                   # Pages Router API
â”‚   â”‚   â””â”€â”€ bookstore/
â”‚   â”‚       â”œâ”€â”€ search.ts           # æœç´¢API
â”‚   â”‚       â”œâ”€â”€ categories.ts       # åˆ†ç±»API
â”‚   â”‚       â”œâ”€â”€ hot.ts              # çƒ­é—¨API
â”‚   â”‚       â”œâ”€â”€ category.ts         # åˆ†ç±»é¡µé¢API
â”‚   â”‚       â”œâ”€â”€ book.ts             # ä¹¦ç±è¯¦æƒ…API
â”‚   â”‚       â”œâ”€â”€ chapter.ts          # ç« èŠ‚å†…å®¹API
â”‚   â”‚       â””â”€â”€ proxy-image.ts      # å›¾ç‰‡ä»£ç†API
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                          # Genkit Flowsï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ genkit.ts
â”‚   â”‚   â””â”€â”€ flows/
â”‚   â”‚       â”œâ”€â”€ generate-story-chapter.ts
â”‚   â”‚       â”œâ”€â”€ refine-chapter-with-world-info.ts
â”‚   â”‚       â”œâ”€â”€ respond-to-prompt-in-role.ts
â”‚   â”‚       â””â”€â”€ review-manuscript.ts
â”‚   â”‚
â”‚   â””â”€â”€ data/                        # é™æ€æ•°æ®
â”‚       â””â”€â”€ community-prompts.json
â”‚
â”œâ”€â”€ docs/                            # æ–‡æ¡£
â”‚   â”œâ”€â”€ ai-image-setup.md           # AIå›¾ç‰‡é…ç½®æŒ‡å—
â”‚   â”œâ”€â”€ proxy-setup.md              # ä»£ç†é…ç½®
â”‚   â”œâ”€â”€ frontend-ai-guide.md        # å‰ç«¯AIæŒ‡å—
â”‚   â”œâ”€â”€ legado-book-source-compatibility.md  # ä¹¦æºå…¼å®¹æ€§
â”‚   â””â”€â”€ blueprint.md                # é¡¹ç›®è“å›¾
â”‚
â”œâ”€â”€ book_sources.json                # ä¹¦æºé…ç½®
â”œâ”€â”€ book_source_auth.json            # ä¹¦æºè®¤è¯
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ next.config.ts
```

---

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. ç»Ÿä¸€AIå®¢æˆ·ç«¯ç³»ç»Ÿï¼ˆå¤šæ¨¡å‹ä¾›åº”å•†æ¶æ„ï¼‰

#### ğŸ¨ æ¶æ„è®¾è®¡ç†å¿µ

**é—®é¢˜åœºæ™¯**ï¼š
- ä¸åŒAIæœåŠ¡å•†APIæ ¼å¼ä¸ä¸€è‡´ï¼ˆGeminiã€OpenAIã€Claudeå„æœ‰åè®®ï¼‰
- åˆ‡æ¢æ¨¡å‹éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç 
- é…ç½®ç®¡ç†æ··ä¹±ï¼Œå¯†é’¥åˆ†æ•£å­˜å‚¨
- æ— æ³•ç»Ÿä¸€ç›‘æ§ä½¿ç”¨æƒ…å†µ

**è§£å†³æ–¹æ¡ˆ**ï¼šè®¾è®¡ç»Ÿä¸€AIå®¢æˆ·ç«¯ (`UnifiedAIClient`)

#### ğŸ“¦ æ ¸å¿ƒç»„ä»¶

**1ï¸âƒ£ æä¾›å•†æŠ½è±¡å±‚** (`src/lib/ai/providers/base.ts`)
```typescript
// ç»Ÿä¸€çš„AIæä¾›å•†æ¥å£
export interface AIProvider {
  readonly id: string;
  readonly type: 'openai' | 'gemini' | 'claude' | 'custom';
  readonly apiUrl: string;
  readonly apiKey: string;
  
  // ç»Ÿä¸€çš„è°ƒç”¨æ–¹æ³•
  generateContent(modelId: string, prompt: string, options?: GenerateOptions): Promise<string>;
  generateContentStream(modelId: string, prompt: string, options?: GenerateOptions): AsyncGenerator<string>;
  listModels(): Promise<AIModel[]>;
  testConnection(): Promise<ConnectionTestResult>;
}
```

**2ï¸âƒ£ å…·ä½“å®ç°**
- `GeminiProvider` - Google Geminiä¸“ç”¨ï¼ˆæ”¯æŒåŠ¨æ€æ€è€ƒï¼‰
- `OpenAICompatibleProvider` - OpenAIå…¼å®¹ï¼ˆæ”¯æŒ99%çš„AIæœåŠ¡ï¼‰
- è‡ªåŠ¨æ£€æµ‹ï¼šå¦‚æœé…ç½®ä¸ºGeminiä½†APIåœ°å€éGoogleï¼Œè‡ªåŠ¨é™çº§ä¸ºOpenAIå…¼å®¹æ¨¡å¼

**3ï¸âƒ£ ç»Ÿä¸€å®¢æˆ·ç«¯** (`src/lib/ai/unified-client.ts`)
```typescript
export class UnifiedAIClient {
  private providers = new Map<string, AIProvider>();
  
  // ç”Ÿæˆå†…å®¹ - ç»Ÿä¸€å…¥å£
  async generateContent(
    providerId: string,
    modelId: string,
    prompt: string,
    options?: GenerateOptions
  ): Promise<string> {
    const provider = this.ensureProviderForCall(
      this.getProvider(providerId)
    );
    return provider.generateContent(modelId, prompt, options);
  }
  
  // è‡ªåŠ¨é€‰æ‹©æœ€ä½³æä¾›å•†
  async selectBestProvider(): Promise<{ providerId: string; modelId: string }> {
    // ä¼˜å…ˆçº§ï¼šGemini > OpenAI > Claude > Custom
    const enabledProviders = this.getEnabledProviders();
    // ... æ™ºèƒ½é€‰æ‹©é€»è¾‘
  }
  
  // è·å–ä½¿ç”¨ç»Ÿè®¡
  getStatsSummary(): {
    totalRequests: number;
    totalTokens: number;
    averageResponseTime: number;
    providerUsage: Record<string, number>;
  }
}
```

#### âš™ï¸ é…ç½®ç®¡ç†ç³»ç»Ÿ (`src/lib/ai/config-manager.ts`)

**åŠŸèƒ½æ¸…å•**ï¼š
```typescript
export class AIConfigManager {
  // CRUDæ“ä½œ
  static addProvider(provider: Omit<AIProviderConfig, 'createdAt' | 'updatedAt'>)
  static updateProvider(providerId: string, updates: Partial<AIProviderConfig>)
  static removeProvider(providerId: string)
  static getProviders(): AIProviderConfig[]
  
  // å¯¼å…¥å¯¼å‡º
  static exportConfig(): string  // å¯¼å‡ºJSONé…ç½®
  static importConfig(configJson: string, options: {
    overwrite?: boolean;    // æ˜¯å¦è¦†ç›–ç°æœ‰é…ç½®
    skipInvalid?: boolean;  // è·³è¿‡æ— æ•ˆé…ç½®
  }): { success: boolean; imported: number; skipped: number; errors: string[] }
  
  // éªŒè¯
  static validateProvider(provider: AIProviderConfig): ConfigValidationResult
  
  // å¥åº·æ£€æŸ¥
  static checkHealth(): { healthy: boolean; issues: Array<{ type: 'error' | 'warning'; message: string }> }
  
  // é…ç½®å˜æ›´ç›‘å¬
  static onConfigChange(callback: (event: ConfigChangeEvent) => void): () => void
}
```

**é…ç½®å¯¼å‡ºæ ¼å¼**ï¼š
```json
{
  "version": "1.0.0",
  "exportedAt": "2025-01-20T10:30:00.000Z",
  "providers": [
    {
      "id": "gemini-main",
      "name": "gemini-main",
      "displayName": "Geminiä¸»è´¦å·",
      "type": "gemini",
      "apiUrl": "https://generativelanguage.googleapis.com/v1beta",
      "apiKey": "AIza...",
      "enabled": true,
      "defaultModel": "gemini-2.5-flash",
      "advancedConfig": {
        "defaultTemperature": 0.9,
        "enableDynamicThinking": true,
        "thinkingBudget": -1
      },
      "createdAt": "2025-01-01T00:00:00.000Z",
      "updatedAt": "2025-01-20T10:00:00.000Z"
    },
    {
      "id": "deepseek-backup",
      "name": "deepseek-backup",
      "displayName": "DeepSeekå¤‡ç”¨",
      "type": "openai",
      "apiUrl": "https://api.deepseek.com/v1",
      "apiKey": "sk-...",
      "enabled": true,
      "defaultModel": "deepseek-chat",
      "customHeaders": {
        "X-Custom-Header": "value"
      }
    }
  ],
  "selectedProvider": "gemini-main",
  "selectedModel": "gemini-2.5-flash"
}
```

#### ğŸ”§ é…ç½®ç•Œé¢ (`src/components/AIProviderSettings.tsx`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… å¯è§†åŒ–Providerç®¡ç†ï¼ˆæ·»åŠ /ç¼–è¾‘/åˆ é™¤/å¯ç”¨/ç¦ç”¨ï¼‰
- âœ… é¢„è®¾æ¨¡æ¿ï¼ˆGeminiã€OpenAIã€Claudeã€DeepSeekã€Moonshotã€æ™ºè°±AIï¼‰
- âœ… è¿æ¥æµ‹è¯•ï¼ˆå®æ—¶æ£€æµ‹APIå¯ç”¨æ€§å’Œå“åº”æ—¶é—´ï¼‰
- âœ… APIå¯†é’¥æ˜¾ç¤º/éšè—/å¤åˆ¶
- âœ… é«˜çº§å‚æ•°é…ç½®ï¼ˆæ¸©åº¦ã€Top-Pã€Top-Kã€æ€è€ƒé¢„ç®—ï¼‰
- âœ… Gemini 2.5ä¸“ç”¨ï¼šåŠ¨æ€æ€è€ƒæ¨¡å¼
- âœ… é…ç½®å¯¼å…¥å¯¼å‡ºï¼ˆJSONæ–‡ä»¶ï¼‰
- âœ… é…ç½®éªŒè¯ï¼ˆURLæ ¼å¼ã€å¿…å¡«å­—æ®µã€å‚æ•°èŒƒå›´ï¼‰
- âœ… å®æ—¶çŠ¶æ€æ˜¾ç¤ºï¼ˆè¿æ¥çŠ¶æ€ã€å“åº”æ—¶é—´ï¼‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```tsx
import { AIProviderSettings } from '@/components/AIProviderSettings';

// åœ¨ä»»æ„é¡µé¢ä½¿ç”¨
<AIProviderSettings 
  showStatus={true}  // æ˜¾ç¤ºå¯ç”¨çŠ¶æ€
  variant="outline"   // æŒ‰é’®æ ·å¼
/>
```

#### ğŸš€ ä½¿ç”¨ç¤ºä¾‹

**æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨ç»Ÿä¸€å®¢æˆ·ç«¯**
```typescript
import { getUnifiedAIClient } from '@/lib/ai/unified-client';

const client = getUnifiedAIClient();

// ä½¿ç”¨æŒ‡å®šæä¾›å•†å’Œæ¨¡å‹
const result = await client.generateContent(
  'gemini-main',
  'gemini-2.5-flash',
  'å†™ä¸€ä¸ªç§‘å¹»æ•…äº‹å¼€å¤´',
  { temperature: 0.9 }
);

// æµå¼ç”Ÿæˆ
for await (const chunk of client.generateContentStream(
  'deepseek-backup',
  'deepseek-chat',
  'ç»§ç»­æ•…äº‹æƒ…èŠ‚'
)) {
  console.log(chunk);
}
```

**æ–¹å¼2ï¼šè‡ªåŠ¨é€‰æ‹©æœ€ä½³Provider**
```typescript
import { autoGenerateContent } from '@/lib/ai/unified-client';

// è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜Providerï¼ˆGeminiä¼˜å…ˆï¼‰
const result = await autoGenerateContent(
  'åˆ†æè¿™æ®µå°è¯´çš„å†™ä½œæ‰‹æ³•',
  { temperature: 0.7 }
);
```

**æ–¹å¼3ï¼šè·å–ä½¿ç”¨ç»Ÿè®¡**
```typescript
const client = getUnifiedAIClient();
const stats = client.getStatsSummary();

console.log(`æ€»è¯·æ±‚: ${stats.totalRequests}`);
console.log(`æ€»Token: ${stats.totalTokens}`);
console.log(`å¹³å‡å“åº”æ—¶é—´: ${stats.averageResponseTime}ms`);
console.log('æä¾›å•†ä½¿ç”¨æƒ…å†µ:', stats.providerUsage);
// è¾“å‡º: { 'gemini-main': 45, 'deepseek-backup': 12 }
```

#### ğŸ’¡ æŠ€æœ¯äº®ç‚¹

1. **å…¼å®¹æ€§é€‚é…**ï¼šè‡ªåŠ¨æ£€æµ‹Geminié…ç½®çš„APIåœ°å€ï¼Œå¦‚æœæŒ‡å‘ç¬¬ä¸‰æ–¹èšåˆæœåŠ¡ï¼Œè‡ªåŠ¨åˆ‡æ¢ä¸ºOpenAIå…¼å®¹æ¨¡å¼
2. **æ™ºèƒ½è·¯ç”±**ï¼šæ ¹æ®æ¨¡å‹ç±»å‹ã€å¯ç”¨æ€§ã€å†å²æˆåŠŸç‡è‡ªåŠ¨é€‰æ‹©æœ€ä½³Provider
3. **é…ç½®è¿ç§»**ï¼šè‡ªåŠ¨æ£€æµ‹æ—§ç‰ˆå•ä¸€Geminié…ç½®ï¼Œè¿ç§»åˆ°æ–°çš„å¤šProviderç³»ç»Ÿ
4. **äº‹ä»¶é©±åŠ¨**ï¼šé…ç½®å˜æ›´å®æ—¶é€šçŸ¥æ‰€æœ‰è®¢é˜…ç»„ä»¶
5. **å¥åº·æ£€æŸ¥**ï¼šå®šæœŸæ‰«æProvideré…ç½®ï¼ŒæŠ¥å‘Šæ½œåœ¨é—®é¢˜
6. **Tokenä¼°ç®—**ï¼šåŸºäºä¸­è‹±æ–‡æ··åˆæ–‡æœ¬çš„æ™ºèƒ½Tokenè®¡æ•°

#### ğŸ¯ æ”¯æŒçš„AIæœåŠ¡å•†

| æœåŠ¡å•† | ç±»å‹ | é»˜è®¤APIåœ°å€ | ç‰¹è‰²åŠŸèƒ½ |
|--------|------|-------------|----------|
| **Google Gemini** | gemini | `generativelanguage.googleapis.com` | åŠ¨æ€æ€è€ƒã€é•¿ä¸Šä¸‹æ–‡ |
| **OpenAI** | openai | `api.openai.com/v1` | GPT-4ã€GPT-3.5 |
| **Anthropic Claude** | claude | `api.anthropic.com/v1` | Claude 3ç³»åˆ— |
| **DeepSeek** | openai | `api.deepseek.com/v1` | æ€§ä»·æ¯”æé«˜ |
| **Moonshot AI** | openai | `api.moonshot.cn/v1` | Kimié•¿æ–‡æœ¬ |
| **æ™ºè°±AI** | openai | `open.bigmodel.cn/api/paas/v4` | ChatGLMå›½äº§ |
| **è‡ªå®šä¹‰** | custom | ä»»æ„OpenAIå…¼å®¹ç«¯ç‚¹ | çµæ´»æ‰©å±• |

---

### 2. å‰ç«¯ç›´è°ƒGemini APIï¼ˆä¼ ç»Ÿå•ä¸€æ¨¡å¼ï¼‰

**ä¸ºä»€ä¹ˆå‰ç«¯ç›´è°ƒï¼Ÿ**
- âœ… æ— éœ€éƒ¨ç½²åç«¯æœåŠ¡å™¨
- âœ… å“åº”é€Ÿåº¦æ›´å¿«ï¼ˆå‡å°‘ä¸€å±‚è½¬å‘ï¼‰
- âœ… ç”¨æˆ·APIå¯†é’¥è‡ªå·±æŒæ§ï¼Œæ›´å®‰å…¨
- âœ… é™ä½æœåŠ¡å™¨æˆæœ¬
- âœ… æ”¯æŒæµå¼è¾“å‡ºï¼ˆSSEï¼‰

**æ ¸å¿ƒå®ç°**ï¼š

```typescript
// src/lib/gemini-client.ts

export async function callGeminiAPI(
  conversationHistory: ChatMessage[],
  chapterContext: string,
  apiKey: string,
  model: string = 'gemini-2.5-flash'
) {
  // æ„å»ºå®Œæ•´å¯¹è¯å†å²
  const contents = [
    {
      role: 'system',
      parts: [{ text: chapterContext }]
    },
    ...conversationHistory.map(msg => ({
      role: msg.role === 'user' ? 'user' : 'model',
      parts: [{ text: msg.content }]
    }))
  ];

  // ç›´æ¥è°ƒç”¨Google API
  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`,
    {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        contents,
        generationConfig: {
          temperature: 0.9,
          maxOutputTokens: 8192,
        }
      })
    }
  );

  const data = await response.json();
  return data.candidates[0].content.parts[0].text;
}
```

### 3. ä¹¦æºè§£æå¼•æ“

**æ”¯æŒçš„è§„åˆ™ç±»å‹**ï¼š

| è§„åˆ™ç±»å‹ | ç¤ºä¾‹ | è¯´æ˜ |
|---------|------|------|
| CSSé€‰æ‹©å™¨ | `.book-title` | æ ‡å‡†CSSé€‰æ‹©å™¨ |
| XPath | `//div[@class='title']` | XPathè¡¨è¾¾å¼ |
| JSONPath | `$.data[*].name` | JSONæ•°æ®æå– |
| JavaScript | `<js>å¤„ç†ä»£ç </js>` | åŠ¨æ€æ‰§è¡ŒJS |
| æ··åˆè§„åˆ™ | `@css:.title@js:text.trim()` | å¤šè§„åˆ™ç»„åˆ |
| æ­£åˆ™æ›¿æ¢ | `replaceRegex` | æ–‡æœ¬æ¸…æ´— |
| å ä½ç¬¦ | `{{page}}`, `{{host()}}` | åŠ¨æ€å˜é‡æ›¿æ¢ |

**æ ¸å¿ƒè§£æå™¨**ï¼š

```typescript
// src/lib/book-source-rule-parser.ts

export function parseRule(
  html: string,
  rule: string,
  context: ParseContext
): string | string[] {
  // 1. å¤„ç†JavaScriptä»£ç å—
  if (rule.includes('<js>')) {
    const jsCode = extractJsCode(rule);
    return executeInSandbox(jsCode, context);
  }

  // 2. å¤„ç†æ··åˆè§„åˆ™ @css + @js
  if (rule.includes('@css') && rule.includes('@js')) {
    const cssResult = parseCssSelector(html, rule);
    const jsResult = executeJs(cssResult, rule);
    return jsResult;
  }

  // 3. å¤„ç†JSONPath
  if (rule.startsWith('$.')) {
    return parseJsonPath(html, rule);
  }

  // 4. å¤„ç†å ä½ç¬¦
  const processed = replacePlaceholders(rule, context);

  // 5. æ ‡å‡†CSSé€‰æ‹©å™¨
  return parseCssSelector(html, processed);
}
```

**å ä½ç¬¦ç³»ç»Ÿ**ï¼š

```typescript
const PLACEHOLDERS = {
  '{{page}}': () => currentPage.toString(),
  '{{host()}}': () => new URL(baseUrl).origin,
  '{{source.bookUrl}}': () => context.bookUrl,
  '{{source.chapterUrl}}': () => context.chapterUrl,
};
```

### 4. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ

**å¤šçº§ç¼“å­˜ç­–ç•¥**ï¼š

```typescript
// src/lib/cache-manager.ts

interface CacheEntry<T> {
  data: T;
  timestamp: number;
  expiry: number;
}

class CacheManager {
  private prefix = 'bookstore_cache_';

  // å­˜å‚¨ç¼“å­˜
  set<T>(key: string, data: T, duration: number): void {
    const entry: CacheEntry<T> = {
      data,
      timestamp: Date.now(),
      expiry: duration
    };
    localStorage.setItem(
      `${this.prefix}${this.hashKey(key)}`,
      JSON.stringify(entry)
    );
  }

  // è¯»å–ç¼“å­˜
  get<T>(key: string): T | null {
    const item = localStorage.getItem(`${this.prefix}${this.hashKey(key)}`);
    if (!item) return null;

    const entry: CacheEntry<T> = JSON.parse(item);
    
    // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
    if (Date.now() > entry.timestamp + entry.expiry) {
      this.delete(key);
      return null;
    }

    return entry.data;
  }

  // æ¸…ç†æ‰€æœ‰è¿‡æœŸç¼“å­˜
  cleanExpired(): void {
    Object.keys(localStorage)
      .filter(key => key.startsWith(this.prefix))
      .forEach(key => {
        const entry = JSON.parse(localStorage.getItem(key)!);
        if (Date.now() > entry.timestamp + entry.expiry) {
          localStorage.removeItem(key);
        }
      });
  }

  // ç”Ÿæˆç¼“å­˜é”®
  private hashKey(key: string): string {
    return btoa(encodeURIComponent(key)).substring(0, 32);
  }
}

export const cacheManager = new CacheManager();
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```typescript
// å…ˆæŸ¥ç¼“å­˜
const cached = cacheManager.get<Book[]>('hot_books');
if (cached) {
  setBooks(cached);
  return;
}

// ç¼“å­˜æœªå‘½ä¸­ï¼Œè¯·æ±‚API
const response = await fetch('/api/bookstore/hot');
const data = await response.json();

// å­˜å…¥ç¼“å­˜ï¼ˆ30åˆ†é’Ÿï¼‰
cacheManager.set('hot_books', data, 30 * 60 * 1000);
setBooks(data);
```

### 5. SSEæµå¼å›¾ç‰‡ç”Ÿæˆ

**Next.js APIè·¯ç”±**ï¼š

```typescript
// src/app/api/ai-image/generate/route.ts

export async function POST(request: Request) {
  const { prompt, count } = await request.json();

  // åˆ›å»ºSSEæµ
  const encoder = new TextEncoder();
  const stream = new TransformStream();
  const writer = stream.writable.getWriter();

  // å¼‚æ­¥å¤„ç†
  (async () => {
    try {
      // 1. æäº¤ä»»åŠ¡
      writer.write(encoder.encode(
        `data: ${JSON.stringify({ type: 'progress', message: 'æäº¤ç”Ÿæˆä»»åŠ¡...' })}\n\n`
      ));

      const taskResponse = await fetch(DOUBAO_API_URL, {
        method: 'POST',
        headers: { 'Authorization': `Bearer ${DOUBAO_API_KEY}` },
        body: JSON.stringify({ prompt, num_images: count })
      });

      const { task_id } = await taskResponse.json();

      // 2. è½®è¯¢ç»“æœ
      let completed = false;
      while (!completed) {
        await new Promise(resolve => setTimeout(resolve, 2000));

        const statusResponse = await fetch(`${DOUBAO_API_URL}/${task_id}`);
        const status = await statusResponse.json();

        // æ¨é€è¿›åº¦
        writer.write(encoder.encode(
          `data: ${JSON.stringify({
            type: 'progress',
            progress: status.progress
          })}\n\n`
        ));

        if (status.status === 'completed') {
          // æ¨é€å›¾ç‰‡
          status.images.forEach((url: string) => {
            writer.write(encoder.encode(
              `data: ${JSON.stringify({ type: 'image', url })}\n\n`
            ));
          });
          completed = true;
        }
      }

      writer.write(encoder.encode(`data: ${JSON.stringify({ type: 'done' })}\n\n`));
    } catch (error) {
      writer.write(encoder.encode(
        `data: ${JSON.stringify({ type: 'error', message: error.message })}\n\n`
      ));
    } finally {
      writer.close();
    }
  })();

  return new Response(stream.readable, {
    headers: {
      'Content-Type': 'text/event-stream',
      'Cache-Control': 'no-cache',
      'Connection': 'keep-alive'
    }
  });
}
```

**å‰ç«¯æ¥æ”¶**ï¼š

```typescript
const eventSource = new EventSource('/api/ai-image/generate', {
  method: 'POST',
  body: JSON.stringify({ prompt, count: 4 })
});

eventSource.addEventListener('message', (event) => {
  const data = JSON.parse(event.data);
  
  switch (data.type) {
    case 'progress':
      setProgress(data.progress);
      break;
    case 'image':
      setImages(prev => [...prev, data.url]);
      break;
    case 'done':
      eventSource.close();
      break;
    case 'error':
      showError(data.message);
      eventSource.close();
      break;
  }
});
```

### 6. åŒé‡ç« èŠ‚å¯¼èˆªç³»ç»Ÿ

**é—®é¢˜åœºæ™¯**ï¼š
- æœ‰äº›ä¹¦æºçš„"ä¸‹ä¸€ç« "é“¾æ¥å®é™…æ˜¯"ä¸‹ä¸€é¡µ"
- å•çº¯ä¾èµ–HTMLè§£æå®¹æ˜“å¯¼è‡´å¯¼èˆªé”™è¯¯
- éœ€è¦å¯é çš„ç« èŠ‚è·³è½¬æœºåˆ¶

**è§£å†³æ–¹æ¡ˆ**ï¼š

```typescript
// src/app/bookstore/read/page.tsx

// æ–¹æ¡ˆ1ï¼šåŸºäºä¹¦ç±ç« èŠ‚åˆ—è¡¨ï¼ˆä¼˜å…ˆï¼‰
async function navigateByChapterList(direction: 'prev' | 'next') {
  // è·å–å®Œæ•´ç« èŠ‚åˆ—è¡¨
  const chaptersResponse = await fetch(`/api/bookstore/book?url=${bookUrl}`);
  const { chapters } = await chaptersResponse.json();

  // å®šä½å½“å‰ç« èŠ‚
  const currentIndex = chapters.findIndex(ch => ch.url === currentChapterUrl);
  
  // è®¡ç®—ç›®æ ‡ç« èŠ‚
  const targetIndex = direction === 'next' ? currentIndex + 1 : currentIndex - 1;
  
  if (targetIndex >= 0 && targetIndex < chapters.length) {
    const targetChapter = chapters[targetIndex];
    router.push(`/bookstore/read?url=${encodeURIComponent(targetChapter.url)}&bookUrl=${encodeURIComponent(bookUrl)}`);
    return true;
  }
  
  return false;
}

// æ–¹æ¡ˆ2ï¼šåŸºäºHTMLæå–ï¼ˆå¤‡ç”¨ï¼‰
async function navigateByHtmlExtraction(direction: 'prev' | 'next') {
  const response = await fetch(`/api/bookstore/chapter?url=${currentChapterUrl}`);
  const { navigation } = await response.json();
  
  // ä¸¥æ ¼åŒºåˆ†"ä¸‹ä¸€ç« "å’Œ"ä¸‹ä¸€é¡µ"
  const targetUrl = direction === 'next' 
    ? navigation.nextChapter  // ä¸æ˜¯nextPageï¼
    : navigation.prevChapter;
  
  if (targetUrl) {
    router.push(`/bookstore/read?url=${encodeURIComponent(targetUrl)}`);
    return true;
  }
  
  return false;
}

// æ™ºèƒ½å¯¼èˆªå‡½æ•°
async function smartNavigate(direction: 'prev' | 'next') {
  // ä¼˜å…ˆä½¿ç”¨ç« èŠ‚åˆ—è¡¨å¯¼èˆª
  if (bookUrl) {
    const success = await navigateByChapterList(direction);
    if (success) return;
  }
  
  // é™çº§åˆ°HTMLæå–
  await navigateByHtmlExtraction(direction);
}
```

**HTMLå¯¼èˆªæå–ä¼˜åŒ–**ï¼š

```typescript
// src/lib/book-source-utils.ts

function extractNavigation(html: string): Navigation {
  const $ = cheerio.load(html);
  
  // æŸ¥æ‰¾å¯¼èˆªé“¾æ¥
  const links = $('a').toArray();
  
  let prevChapter = null;
  let nextChapter = null;
  
  links.forEach(link => {
    const text = $(link).text().trim();
    const href = $(link).attr('href');
    
    // ä¸¥æ ¼åŒ¹é…"ä¸Šä¸€ç« "
    if (/ä¸Šä¸€ç« |ä¸Šä¸€èŠ‚|ä¸Šä¸€å›/.test(text)) {
      prevChapter = resolveUrl(href, baseUrl);
    }
    
    // ä¸¥æ ¼åŒ¹é…"ä¸‹ä¸€ç« "ï¼Œæ’é™¤"ä¸‹ä¸€é¡µ"
    if (/ä¸‹ä¸€ç« |ä¸‹ä¸€èŠ‚|ä¸‹ä¸€å›/.test(text) && !/ä¸‹ä¸€é¡µ/.test(text)) {
      nextChapter = resolveUrl(href, baseUrl);
    }
  });
  
  return { prevChapter, nextChapter };
}
```

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | è¯´æ˜ |
|-----|------|
| [AIå›¾ç‰‡é…ç½®æŒ‡å—](docs/ai-image-setup.md) | è±†åŒ…AIå›¾ç‰‡ç”Ÿæˆå®Œæ•´é…ç½®æ•™ç¨‹ |
| [ä»£ç†è®¾ç½®æŒ‡å—](docs/proxy-setup.md) | å›½å†…æœåŠ¡å™¨è®¿é—®GoogleæœåŠ¡çš„ä»£ç†é…ç½® |
| [å‰ç«¯AIå¼€å‘æŒ‡å—](docs/frontend-ai-guide.md) | å‰ç«¯ç›´è°ƒGemini APIçš„æœ€ä½³å®è·µ |
| [ä¹¦æºå…¼å®¹æ€§è¯´æ˜](docs/legado-book-source-compatibility.md) | é˜…è¯»APPä¹¦æºæ ¼å¼å…¼å®¹æ€§æ–‡æ¡£ |
| [é¡¹ç›®è“å›¾](docs/blueprint.md) | é¡¹ç›®æ•´ä½“æ¶æ„å’Œæœªæ¥è§„åˆ’ |

---

## ğŸ”§ å¸¸è§é—®é¢˜ FAQ

### Q1: å›½å†…èƒ½ç”¨å—ï¼Ÿ

**A:** å¯ä»¥ï¼ä½†éœ€è¦æ³¨æ„ï¼š

- **å‰ç«¯ç›´è°ƒæ¨¡å¼**ï¼šå–å†³äºä½ çš„æœ¬åœ°ç½‘ç»œç¯å¢ƒã€‚å¦‚æœä½ çš„ç”µè„‘å¯ä»¥è®¿é—®Googleï¼ˆé€šè¿‡VPNç­‰ï¼‰ï¼Œå°±èƒ½æ­£å¸¸ä½¿ç”¨æ‰€æœ‰AIåŠŸèƒ½ã€‚
- **æœåŠ¡ç«¯æ¨¡å¼**ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœéƒ¨ç½²åœ¨å›½å†…æœåŠ¡å™¨ï¼Œéœ€è¦é…ç½®HTTPä»£ç†ã€‚è¯¦è§ [docs/proxy-setup.md](docs/proxy-setup.md)

### Q2: API Keyå®‰å…¨å—ï¼Ÿ

**A:** å®Œå…¨å®‰å…¨ï¼

- âœ… å¯†é’¥ä»…ä¿å­˜åœ¨æµè§ˆå™¨ `localStorage`
- âœ… ä¸ä¼šå‘é€åˆ°ä»»ä½•æœåŠ¡å™¨
- âœ… ä¸ä¼šè®°å½•åœ¨æ—¥å¿—ä¸­
- âœ… å®Œå…¨ç”±ä½ è‡ªå·±æŒæ§
- âœ… å¯éšæ—¶æ¸…é™¤æˆ–æ›´æ¢

### Q3: ä¸ºä»€ä¹ˆæ¨è gemini-2.5-flashï¼Ÿ

**A:** æ€§ä»·æ¯”æœ€é«˜ï¼

| æ¨¡å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|-----|------|---------|
| `gemini-2.5-flash` | é€Ÿåº¦å¿«ã€ä¾¿å®œã€è´¨é‡é«˜ | **æ¨è**ï¼šæ—¥å¸¸åˆ›ä½œã€åˆ†æ |
| `gemini-2.5-pro` | æœ€å¼ºæ€è€ƒèƒ½åŠ› | å¤æ‚é€»è¾‘ã€æ·±åº¦åˆ†æ |
| `gemini-1.5-pro` | ä¸Šä¸€ä»£æ——èˆ° | é•¿æ–‡æœ¬å¤„ç† |
| `gemini-1.5-flash` | ä¸Šä¸€ä»£å¿«é€Ÿç‰ˆ | é¢„ç®—æœ‰é™ |

### Q4: é‡åˆ°è¯·æ±‚å—é™æ€ä¹ˆåŠï¼Ÿ

**A:** å¤šç§è§£å†³æ–¹æ¡ˆï¼š

1. **ç­‰å¾…é…é¢æ¢å¤** - å…è´¹ç‰ˆæ¯åˆ†é’Ÿ15æ¬¡ã€æ¯å¤©1500æ¬¡
2. **åˆ‡æ¢æ¨¡å‹** - æ¢åˆ° `gemini-2.5-flash`ï¼ˆæ¶ˆè€—æ›´å°‘ï¼‰
3. **ä¼˜åŒ–æç¤ºè¯** - å‡å°‘ä¸å¿…è¦çš„é•¿æ–‡æœ¬è¾“å…¥
4. **ä½¿ç”¨ç¼“å­˜** - é¿å…é‡å¤ç›¸åŒè¯·æ±‚
5. **å‡çº§ä»˜è´¹** - Google AI Studioæ”¯æŒä»˜è´¹æå‡é…é¢

### Q5: ä¹¦åŸæ‰“ä¸å¼€æˆ–è¶…æ—¶ï¼Ÿ

**A:** æ’æŸ¥æ­¥éª¤ï¼š

1. **æ£€æŸ¥ä¹¦æºçŠ¶æ€** - ç›®æ ‡ç½‘ç«™å¯èƒ½æš‚æ—¶ä¸å¯ç”¨
2. **é…ç½®Cookie** - æœ‰äº›ç½‘ç«™éœ€è¦ç™»å½•ï¼Œåœ¨ã€Œä¹¦æºè®¾ç½®ã€â†’ã€Œè®¤è¯ç®¡ç†ã€ä¸­æ·»åŠ Cookie
3. **è®¾ç½®ä»£ç†** - ä¸ºç‰¹å®šä¹¦æºé…ç½® `proxyBase`
4. **æ›´æ¢ä¹¦æº** - å°è¯•å…¶ä»–å¯ç”¨ä¹¦æº
5. **æŸ¥çœ‹æ§åˆ¶å°** - æŒ‰F12æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯

### Q6: å¦‚ä½•æ·»åŠ æ–°ä¹¦æºï¼Ÿ

**A:** ç¼–è¾‘ `book_sources.json`ï¼š

```json
{
  "bookSourceName": "ç¤ºä¾‹ä¹¦æº",
  "bookSourceUrl": "https://example.com",
  "bookSourceType": 0,
  "searchUrl": "https://example.com/search?key={{key}}",
  "ruleSearch": {
    "bookList": ".book-list > .item",
    "name": ".title",
    "author": ".author",
    "coverUrl": "img@src",
    "bookUrl": "a@href"
  },
  "ruleBookInfo": {
    "name": ".book-name",
    "author": ".author-name",
    "intro": ".intro",
    "coverUrl": ".cover@src",
    "tocUrl": "{{bookUrl}}/chapters"
  },
  "ruleToc": {
    "chapterList": ".chapter-list > li",
    "chapterName": "a",
    "chapterUrl": "a@href"
  },
  "ruleContent": {
    "content": ".chapter-content",
    "nextPageUrl": ".next-page@href"
  }
}
```

è¯¦è§ï¼š[docs/legado-book-source-compatibility.md](docs/legado-book-source-compatibility.md)

### Q7: å¦‚ä½•è´¡çŒ®ä»£ç ï¼Ÿ

**A:** æ¬¢è¿è´¡çŒ®ï¼

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/AmazingFeature`
3. æäº¤æ”¹åŠ¨ï¼š`git commit -m 'Add some AmazingFeature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/AmazingFeature`
5. æäº¤Pull Request

### Q8: ç§»åŠ¨ç«¯ä½“éªŒå¦‚ä½•ï¼Ÿ

**A:** å®Œå…¨é€‚é…ï¼

- âœ… å“åº”å¼å¸ƒå±€ï¼ˆå›¾å¢™æ¨¡å¼ï¼‰
- âœ… è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
- âœ… ç§»åŠ¨ç«¯ä¼˜åŒ–çš„å­—ä½“å’Œé—´è·
- âœ… Hoveræ‚¬æµ®å±‚ï¼ˆé•¿æŒ‰è§¦å‘ï¼‰
- âœ… åº•éƒ¨å¯¼èˆªæ 
- âœ… PWAæ”¯æŒï¼ˆå¯æ·»åŠ åˆ°ä¸»å±å¹•ï¼‰

### Q9: å¯ä»¥ç¦»çº¿ä½¿ç”¨å—ï¼Ÿ

**A:** éƒ¨åˆ†åŠŸèƒ½æ”¯æŒï¼š

- âœ… å·²ç¼“å­˜çš„ä¹¦åŸæ•°æ®
- âœ… æœ¬åœ°åˆ›ä½œçš„ç« èŠ‚å’Œè®¾å®š
- âœ… å·²ä¸‹è½½çš„è§’è‰²å¡ç‰‡
- âŒ AIåŠŸèƒ½éœ€è¦ç½‘ç»œ
- âŒ ä¹¦åŸæ–°å†…å®¹éœ€è¦ç½‘ç»œ

### Q10: å¦‚ä½•åŒæ—¶ä½¿ç”¨å¤šä¸ªAIæä¾›å•†ï¼Ÿ

**A:** ä½¿ç”¨ç»Ÿä¸€AIé…ç½®ç³»ç»Ÿï¼š

1. **æ·»åŠ å¤šä¸ªProvider** - åœ¨AIé…ç½®ç•Œé¢æ·»åŠ Geminiã€DeepSeekã€OpenAIç­‰
2. **è®¾ç½®ä¼˜å…ˆçº§** - å¯ç”¨/ç¦ç”¨ä¸åŒProviderï¼Œç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©
3. **è‡ªåŠ¨æ•…éšœè½¬ç§»** - ä¸»Providerå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢å¤‡ç”¨
4. **é…ç½®å¯¼å‡º** - ä¸€é”®å¯¼å‡ºæ‰€æœ‰é…ç½®ï¼Œæ–¹ä¾¿è¿ç§»å’Œå¤‡ä»½

**æ¨èé…ç½®**ï¼š
- **ä¸»åŠ›**ï¼šGemini 2.5 Flashï¼ˆå…è´¹é¢åº¦å¤§ï¼‰
- **å¤‡ç”¨1**ï¼šDeepSeekï¼ˆæ€§ä»·æ¯”é«˜ï¼Œå›½å†…å¯ç”¨ï¼‰
- **å¤‡ç”¨2**ï¼šMoonshot AIï¼ˆé•¿æ–‡æœ¬åœºæ™¯ï¼‰

### Q11: é…ç½®å¯¼å…¥å¯¼å‡ºæ€ä¹ˆç”¨ï¼Ÿ

**A:** å®Œæ•´çš„é…ç½®ç®¡ç†æµç¨‹ï¼š

**å¯¼å‡ºé…ç½®**ï¼š
1. æ‰“å¼€ã€ŒAIé…ç½®ã€
2. ç‚¹å‡»ã€Œå¯¼å‡ºé…ç½®ã€æŒ‰é’®
3. è‡ªåŠ¨ä¸‹è½½ `ai-providers-YYYY-MM-DD.json` æ–‡ä»¶

**å¯¼å…¥é…ç½®**ï¼š
1. æ‰“å¼€ã€ŒAIé…ç½®ã€
2. ç‚¹å‡»ã€Œå¯¼å…¥é…ç½®ã€ï¼Œé€‰æ‹©JSONæ–‡ä»¶
3. é€‰æ‹©å¯¼å…¥é€‰é¡¹ï¼š
   - è·³è¿‡å·²å­˜åœ¨çš„é…ç½®ï¼ˆé»˜è®¤ï¼‰
   - è¦†ç›–ç°æœ‰é…ç½®
4. ç³»ç»Ÿè‡ªåŠ¨éªŒè¯å¹¶å¯¼å…¥æœ‰æ•ˆé…ç½®

**åº”ç”¨åœºæ™¯**ï¼š
- å›¢é˜Ÿå…±äº«é…ç½®
- å¤šè®¾å¤‡åŒæ­¥
- é…ç½®å¤‡ä»½
- å¿«é€Ÿéƒ¨ç½²

### Q12: æ€§èƒ½å¦‚ä½•ä¼˜åŒ–ï¼Ÿ

**A:** å†…ç½®å¤šé‡ä¼˜åŒ–ï¼š

1. **æ™ºèƒ½ç¼“å­˜** - å¤šçº§ç¼“å­˜ç­–ç•¥å‡å°‘90%é‡å¤è¯·æ±‚
2. **æŒ‰éœ€åŠ è½½** - ç»„ä»¶æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²
3. **å›¾ç‰‡ä¼˜åŒ–** - Next.js Imageè‡ªåŠ¨ä¼˜åŒ–
4. **SSG/SSRæ··åˆ** - é™æ€é¡µé¢+åŠ¨æ€è·¯ç”±
5. **CDNåŠ é€Ÿ** - é™æ€èµ„æºCDNåˆ†å‘
6. **AIæ™ºèƒ½è·¯ç”±** - è‡ªåŠ¨é€‰æ‹©æœ€å¿«å“åº”çš„Provider

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Verceléƒ¨ç½²ï¼ˆæ¨èï¼‰

1. Forkæœ¬ä»“åº“
2. ç™»å½• [Vercel](https://vercel.com)
3. ç‚¹å‡»ã€ŒImport Projectã€
4. é€‰æ‹©ä½ çš„ä»“åº“
5. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚éœ€æœåŠ¡ç«¯AIï¼‰ï¼š
   ```
   GEMINI_API_KEY=your_key
   DOUBAO_API_KEY=your_key
   ```
6. ç‚¹å‡»ã€ŒDeployã€

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t dog-writing-engine .

# è¿è¡Œå®¹å™¨
docker run -p 9002:9002 \
  -e GEMINI_API_KEY=your_key \
  dog-writing-engine
```

### ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²

```bash
# 1. æ„å»º
npm run build

# 2. å¯åŠ¨
npm run start

# 3. ä½¿ç”¨PM2å®ˆæŠ¤è¿›ç¨‹
pm2 start npm --name "dog-writing" -- start
pm2 save
pm2 startup
```

---

## ğŸ¨ æˆªå›¾å±•ç¤º

### ğŸ“± ä¹¦åŸä¸»é¡µ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ” æœç´¢æ¡†                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“š çƒ­é—¨æ¨èï¼ˆå›¾å¢™å¸ƒå±€ï¼‰            â”‚
â”‚  â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”   â”‚
â”‚  â”‚ğŸ“•â”‚ â”‚ğŸ“—â”‚ â”‚ğŸ“˜â”‚ â”‚ğŸ“™â”‚ â”‚ğŸ“”â”‚ â”‚ğŸ““â”‚   â”‚
â”‚  â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”   â”‚
â”‚  â”‚ğŸ“•â”‚ â”‚ğŸ“—â”‚ â”‚ğŸ“˜â”‚ â”‚ğŸ“™â”‚ â”‚ğŸ“”â”‚ â”‚ğŸ““â”‚   â”‚
â”‚  â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‚ åˆ†ç±»å¯¼èˆª                        â”‚
â”‚  [ç„å¹»] [æ­¦ä¾ ] [éƒ½å¸‚] [è¨€æƒ…] ...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¤– AIä»¿å†™å·¥ä½œåŒº
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“– ã€Šç¤ºä¾‹å°è¯´ã€‹- ç¬¬1ç«              â”‚
â”‚  [æ¸…ç©ºä¼šè¯]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç« èŠ‚å†…å®¹æ˜¾ç¤ºåŒºåŸŸ...                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¬ å¯¹è¯å†å²                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ‘¤ ç”¨æˆ·: åˆ†æè¿™æ®µçš„å†™ä½œæ‰‹æ³•  â”‚ â”‚
â”‚  â”‚ [ç¼–è¾‘] [åˆ é™¤]                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¤– AI: è¿™æ®µé‡‡ç”¨äº†...          â”‚ â”‚
â”‚  â”‚ [ç¼–è¾‘] [åˆ é™¤]                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¿«æ·åŠŸèƒ½ï¼š                         â”‚
â”‚  [ä»¿å†™å¼€å¤´] [å‰§æƒ…æ€»ç»“] [å–ç‚¹åˆ†æ]  â”‚
â”‚  [è§’è‰²åˆ†æ] [å†™ä½œé£æ ¼]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’­ è¾“å…¥æ¡†ï¼ˆå¤šè¡Œï¼‰                  â”‚
â”‚  æç¤ºï¼šCtrl+Enter å‘é€             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¨ AIå›¾ç‰‡ç”Ÿæˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨ AIå›¾ç‰‡ç”Ÿæˆ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ æè¿°è¾“å…¥æ¡†                      â”‚
â”‚  [æç¤ºè¯ç¤ºä¾‹â–¼]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å¼€å§‹ç”Ÿæˆ]                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ–¼ï¸ ç”Ÿæˆç»“æœï¼ˆå›¾å¢™ï¼‰                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚  â”‚
â”‚  â”‚ ğŸ­  â”‚ â”‚ ğŸŒ„  â”‚ â”‚ ğŸ¦„  â”‚ â”‚ ğŸ°  â”‚  â”‚
â”‚  â”‚     â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [ä¸‹è½½] [ä¸‹è½½] [ä¸‹è½½] [ä¸‹è½½]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›£ è·¯çº¿å›¾ Roadmap

### âœ… å·²å®Œæˆ

- [x] **ç»Ÿä¸€AIå®¢æˆ·ç«¯ç³»ç»Ÿ** - æ”¯æŒ7+AIæœåŠ¡å•†
- [x] **é…ç½®å¯¼å…¥å¯¼å‡º** - JSONæ ¼å¼é…ç½®ç®¡ç†
- [x] **å¤šProviderç®¡ç†** - æ·»åŠ /ç¼–è¾‘/åˆ é™¤/æµ‹è¯•è¿æ¥
- [x] **æ™ºèƒ½è·¯ç”±** - è‡ªåŠ¨é€‰æ‹©æœ€ä½³Provider
- [x] **AIç‡æ£€æµ‹ï¼ˆé€†å‘ï¼‰** - é€†å‘ailv.run API
- [x] **åŸºç¡€AIåˆ›ä½œåŠŸèƒ½** - Gemini/OpenAI/Claudeç­‰é›†æˆ
- [x] **åœ¨çº¿ä¹¦åŸç³»ç»Ÿ** - å¤šä¹¦æºè§£æå¼•æ“
- [x] **AIä»¿å†™å¯¹è¯ç®¡ç†** - æ¶ˆæ¯ç¼–è¾‘/åˆ é™¤/å¤šè¡Œè¾“å…¥
- [x] **AIå›¾ç‰‡ç”Ÿæˆ** - è±†åŒ…AI + SSEæµå¼
- [x] **æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ** - å¤šçº§ç¼“å­˜ï¼Œå‡å°‘90%è¯·æ±‚
- [x] **ç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡** - å›¾å¢™å¸ƒå±€
- [x] **ç« èŠ‚/è§’è‰²/ä¸–ç•Œè§‚ç®¡ç†** - å®Œæ•´åˆ›ä½œå·¥å…·é›†
- [x] **åŒé‡ç« èŠ‚å¯¼èˆª** - å¯é çš„ç« èŠ‚è·³è½¬
- [x] **ä½¿ç”¨ç»Ÿè®¡** - Tokenè®¡æ•°ã€å“åº”æ—¶é—´è¿½è¸ª

### ğŸš§ è¿›è¡Œä¸­

- [ ] PWAæ”¯æŒï¼ˆæ·»åŠ åˆ°ä¸»å±å¹•ï¼‰
- [ ] ç¦»çº¿æ¨¡å¼å¢å¼º
- [ ] æ›´å¤šAIæ¨¡å‹æ”¯æŒï¼ˆOpenAIã€Claudeï¼‰
- [ ] ååŒç¼–è¾‘åŠŸèƒ½

### ğŸ“‹ è®¡åˆ’ä¸­

- [ ] ç§»åŠ¨ç«¯APPï¼ˆReact Nativeï¼‰
- [ ] æ¡Œé¢ç«¯åº”ç”¨ï¼ˆElectronï¼‰
- [ ] äº‘ç«¯åŒæ­¥ï¼ˆFirebase/Supabaseï¼‰
- [ ] ç¤¾åŒºåˆ†äº«åŠŸèƒ½
- [ ] æ’ä»¶å¸‚åœº
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] AIè¯­éŸ³æœ—è¯»
- [ ] å›¾è¡¨å¯è§†åŒ–ï¼ˆèŠ‚å¥åˆ†æã€è§’è‰²å…³ç³»å›¾ï¼‰
- [ ] å¯¼å‡ºåŠŸèƒ½ï¼ˆPDFã€EPUBã€DOCXï¼‰
- [ ] ç‰ˆæœ¬æ§åˆ¶ï¼ˆGit-likeï¼‰

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### è´¡çŒ®æ–¹å¼

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼š

- ğŸ› **æŠ¥å‘ŠBug** - æäº¤Issueæè¿°é—®é¢˜
- ğŸ’¡ **åŠŸèƒ½å»ºè®®** - åˆ†äº«ä½ çš„æƒ³æ³•
- ğŸ“ **æ”¹è¿›æ–‡æ¡£** - ä¿®æ­£é”™è¯¯æˆ–è¡¥å……è¯´æ˜
- ğŸ’» **æäº¤ä»£ç ** - ä¿®å¤Bugæˆ–æ·»åŠ æ–°åŠŸèƒ½
- ğŸŒ **ç¿»è¯‘** - å¸®åŠ©å¤šè¯­è¨€æ”¯æŒ
- â­ **Staré¡¹ç›®** - è®©æ›´å¤šäººå‘ç°

### å¼€å‘æµç¨‹

1. **Forkä»“åº“**
2. **åˆ›å»ºåˆ†æ”¯**ï¼š`git checkout -b feature/NewFeature`
3. **ç¼–å†™ä»£ç **ï¼šéµå¾ªTypeScriptå’ŒReactæœ€ä½³å®è·µ
4. **æµ‹è¯•åŠŸèƒ½**ï¼šç¡®ä¿ä¸å½±å“ç°æœ‰åŠŸèƒ½
5. **æäº¤æ”¹åŠ¨**ï¼š`git commit -m 'Add NewFeature'`
6. **æ¨é€åˆ†æ”¯**ï¼š`git push origin feature/NewFeature`
7. **æäº¤PR**ï¼šè¯¦ç»†æè¿°æ”¹åŠ¨å’Œæµ‹è¯•æƒ…å†µ

### ä»£ç è§„èŒƒ

- **TypeScript** - ä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼Œé¿å… `any`
- **ç»„ä»¶** - åŠŸèƒ½ç»„ä»¶ + Hooksï¼Œé¿å…classç»„ä»¶
- **æ ·å¼** - ä½¿ç”¨Tailwind CSSï¼Œé¿å…å†…è”æ ·å¼
- **å‘½å** - é©¼å³°å‘½åï¼ˆcamelCaseï¼‰ç”¨äºå˜é‡ï¼Œå¸•æ–¯å¡ï¼ˆPascalCaseï¼‰ç”¨äºç»„ä»¶
- **æ³¨é‡Š** - å¤æ‚é€»è¾‘å¿…é¡»æ³¨é‡Š
- **æ ¼å¼** - ä½¿ç”¨Prettieræ ¼å¼åŒ–

### Commitè§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤Bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é…ç½®
```

ç¤ºä¾‹ï¼š
```bash
feat: æ·»åŠ AIå›¾ç‰‡æ‰¹é‡ä¸‹è½½åŠŸèƒ½
fix: ä¿®å¤ä¹¦åŸç¼“å­˜è¿‡æœŸåˆ¤æ–­é”™è¯¯
docs: æ›´æ–°éƒ¨ç½²æŒ‡å—
```

---

## ğŸ™ è‡´è°¢

### æŠ€æœ¯æ ˆ

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Next.js](https://nextjs.org/) - Reactå…¨æ ˆæ¡†æ¶
- [React](https://reactjs.org/) - UIåº“
- [TypeScript](https://www.typescriptlang.org/) - ç±»å‹å®‰å…¨
- [Tailwind CSS](https://tailwindcss.com/) - CSSæ¡†æ¶
- [shadcn/ui](https://ui.shadcn.com/) - ç»„ä»¶åº“
- [Lucide](https://lucide.dev/) - å›¾æ ‡åº“
- [Cheerio](https://cheerio.js.org/) - HTMLè§£æ
- [Firebase](https://firebase.google.com/) - åç«¯æœåŠ¡

### AIæœåŠ¡

- [Google Gemini](https://ai.google.dev/) - æ™ºèƒ½åˆ›ä½œèƒ½åŠ›
- [è±†åŒ…AI](https://www.volcengine.com/) - å›¾ç‰‡ç”ŸæˆæœåŠ¡
- ailv.run - AIæ£€æµ‹æœåŠ¡ï¼ˆé€šè¿‡é€†å‘å·¥ç¨‹å®ç°å…è´¹è°ƒç”¨ï¼‰

### çµæ„Ÿæ¥æº

- [é˜…è¯»APP](https://github.com/gedoor/legado) - ä¹¦æºæ ¼å¼å‚è€ƒ
- [Novel AI](https://novelai.net/) - åˆ›ä½œå·¥å…·çµæ„Ÿ
- [Notion](https://notion.so/) - ç®¡ç†ç•Œé¢å‚è€ƒ

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **MIT** è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

```
MIT License

Copyright (c) 2025 Dogå†™ä½œå¼•æ“

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## ğŸ“ è”ç³»æ–¹å¼

- **GitHub Issues**: [æäº¤Issue](https://github.com/your-username/dog-writing-engine/issues)
- **qq**: [å‚ä¸è®¨è®º](ç‚¹å‡»é“¾æ¥åŠ å…¥ç¾¤èŠã€å¼€æºç‹—ç‹—ç å­—é¡¹ç›®ã€‘ï¼šhttps://qun.qq.com/universal-share/share?ac=1&authKey=8UGSD089UNOpMasstObtoNIehS8FQ10xBgpCJQ7tDcS8OU0YxMfvZi3aajlPS%2BpA&busi_data=eyJncm91cENvZGUiOiIxMDMzNzI1NzcyIiwidG9rZW4iOiJaVFhYS0JJZGJJbS9JQ1d5alNQZEVSS1oyS05pYXJ4Ky9La1lILzkyZHduN1hhUzBISnAraUNxLzRPTVY0eHQ3IiwidWluIjoiMzUyNzIyODgxOSJ9&data=d1f6kgQIHnEM8aPynSOSyz_Yptt661InyHuv-6L8MsgJnntWQ7bsWhwdMIp4krBMfc8s7CJdVVGYy2TtoQvyVQ&svctype=4&tempid=h5_group_info)
- **Email**: 3527228819@qq.com

---

## â­ Starå†å²

[![Star History Chart](https://api.star-history.com/svg?repos=your-username/dog-writing-engine&type=Date)](https://star-history.com/#your-username/dog-writing-engine&Date)

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ªâ­Staræ”¯æŒä¸€ä¸‹ï¼**

Made with â¤ï¸ by Dogå†™ä½œå¼•æ“å›¢é˜Ÿ

[â¬† å›åˆ°é¡¶éƒ¨](#-dogå†™ä½œå¼•æ“---æ–°ä¸€ä»£aiå°è¯´åˆ›ä½œå¹³å°)

</div>
